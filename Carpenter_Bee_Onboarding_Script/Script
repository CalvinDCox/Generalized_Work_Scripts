# Mapc Onboarding Script
# Calvin D. Cox
# Creates new users in AD and also Email

#Section will eventually ask the user for information
$firstname = "John"
$lastname = "Doe"
$department = "Loitering"
$jobtitle = "Desk Analyst"
$Password = ConvertTo-SecureString -String "[Redacted]" -AsPlainText -force #created from default password, gonna need to force user to change on sign-on
$username = $firstname.Substring(0,1) + $lastname
$displayname = $lastname + ", " + $firstname
$emailaddress = $username + "@mapc.org"

#Append -WhatIf to all commands to check functionality before going live.

New-Item -ItemType directory -Path [\\Home\Directory\Path] -WhatIf

New-ADUser -Name $displayname `
-AccountPassword $Password `
-ChangePasswordAtLogon 1 `
-Company "MAPC" `
-Department $department `
-DisplayName $displayname `
-EmailAddress $emailaddress `
-Enabled 1 `
-Description $jobtitle `
-HomeDirectory [\\Home\Directory\Path] `
-Path 
-WhatIf
